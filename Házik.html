<html>

	<head>
		<style>
			#table1
			{
				width:413px;
				border-style:solid;
				text-align:center;
				margin:10px auto 25px auto;
			}
			
			#table2
			{
				table-layout:fixed;
				width:800px;
				text-align:center;
				margin:10px auto 0px auto;
			}
		</style>
		
		<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
	</head>
	
	<body onload="onloadFunction()">
		<table id="table1">
		<tr>
		<td>Tantárgy</td>	<td>Házi</td>	<td>Határidő</td>
		</tr>
		<tr>
		<td><input id="text1" type="text" /></td>	<td><input id="text2" type="text" /></td>	<td><input id="addDeadline" type="date" /></td>	<td><input id="addButton" value="Hozzáadás" type="submit" onclick="addClick()" /></td>
		</tr>
		</table>
		
		<table id="table2">
		<tr>
		<td>
		<div id="subjectSort" onclick="sortBySubject(this.id)" style="cursor:pointer; width:61px; margin:auto;"><b>Tantárgy</b></div>
		</td>
		<td>
		<div id="homeworkSort" onclick="sortByHomework(this.id)" style="cursor:pointer; width:30px; margin:auto;"><b>Házi</b></div>
		</td>
		<td>
		<div id="deadlineHead" onclick="sortByDeadline(this.id)" style="cursor:pointer; width:60px; margin:auto;"><b>Határidő</b></div>
		</td>
		</tr>
		</table>
		
		<script>
				var makeTwoDigit = function(input)
				{
					if( input < 10 )
					{
						return ( "0" + input );
					}
					
					else
					{
						return input;
					}
				}
					
				var onloadFunction = function()
				{
					var currentDate = new Date();
					 
					var year = currentDate.getFullYear();
					var month = makeTwoDigit( currentDate.getMonth() + 1 );
					var day = makeTwoDigit( currentDate.getDate() );
					 
					var currentDate = year + "-" + month + "-" + day;
					window.currentDate = currentDate;
					document.getElementById( "addDeadline" ).value = currentDate;
				};
				
				var valuesArray = [];
				
				var addClick = function()
				{
					var addWhileNotEnd = true;
					var addWhileId = 0;

					while ( addWhileNotEnd === true )
					{
						addWhileId = addWhileId + 1;
						
						if ( document.getElementById( "deleteButton" + addWhileId ) === null )
						{
							if ( document.getElementById( "text1" ).value.length === 0 && document.getElementById( "text2" ).value.length === 0 )
							{
								alert( "Nem írtál be semmit!" );
								addWhileNotEnd = false;
							}
							
							else if ( document.getElementById( "text1" ).value.length === 0 )
							{
								alert( "Nem írtál be tantárgyat!" );
								addWhileNotEnd = false;
							}
							
							else if ( document.getElementById( "text2" ).value.length === 0 )
							{
								alert( "Nem írtál be házit!" );
								addWhileNotEnd = false;
							}
								
							else
							{
								var homeworkTable = document.getElementById( "table2" );
								homeworkTable.style = "border-width:5px;";
								homeworkTable.innerHTML +=
									[
									'<tr id="tr">',
									'<td id="subject" onclick ="editClick(this.id)">',
									document.getElementById( "text1" ).value,
									'</td>',
									'<td id="homework" onclick ="editClick(this.id)">',
									document.getElementById( "text2" ).value,
									'</td>',
									'<td id="deadline" onclick ="editClick(this.id)">',
									document.getElementById( "addDeadline" ).value.replace( /\-/g, "." ) + ".",
									'</td>',
									'<td>',
									'<input type="button" value="Törlés" onclick="deleteClick(this.id)" id="deleteButton" />',
									'</td>',
									'</tr>'
									].join( "" );
								document.body.appendChild(homeworkTable);
								
								document.getElementById( "tr" ).id += addWhileId;
								document.getElementById( "deleteButton" ).id += addWhileId;
								document.getElementById( "subject" ).id += addWhileId;
								document.getElementById( "homework" ).id += addWhileId;
								document.getElementById( "deadline" ).id += addWhileId;
								
								valuesArray[ addWhileId ] = [];
								
								valuesArray[ addWhileId ][ 1 ] = document.getElementById( "text1" ).value;
								valuesArray[ addWhileId ][ 2 ] = document.getElementById( "text2" ).value;
								valuesArray[ addWhileId ][ 3 ] = document.getElementById( "addDeadline" ).value;
								
								document.getElementById( "text1" ).value = "";
								document.getElementById( "text2" ).value = "";
								document.getElementById( "addDeadline" ).value = currentDate;
								
								addWhileNotEnd = false;
							}
						}
					}
				};
				
				var deleteClick = function( clickedId )
				{
					var deleteQuestion = confirm( "Biztosan törlöd?" );
					
					if ( deleteQuestion === true )
					{
						var deletableElement = document.getElementById( clickedId ).parentNode.parentNode;
						deletableElement.parentNode.removeChild( deletableElement );
						
						var trTags = document.getElementsByTagName( "tr" );
						var deleteId = 0;
						
						for (var i = 0; i < trTags.length - 3; i++ )
						{
							deleteId = deleteId + 1;
							
							if( document.getElementById( "deleteButton" + deleteId ) === null )
							{
								document.getElementById( "deleteButton" + ( deleteId + 1) ).id = "deleteButton" + deleteId;
								document.getElementById( "subject" + ( deleteId + 1) ).id = "subject" + deleteId;
								document.getElementById( "homework" + ( deleteId + 1) ).id = "homework" + deleteId;
								document.getElementById( "deadline" + ( deleteId + 1) ).id = "deadline" + deleteId;
								
								valuesArray[deleteId][ 1 ] = valuesArray[deleteId + 1 ][ 1 ];
								valuesArray[deleteId][ 2 ] = valuesArray[deleteId + 1 ][ 2 ];
								valuesArray[deleteId][ 3 ] = valuesArray[deleteId + 1 ][ 3 ];
							}
						}
					}
				};
				
				var editFunction = function( columnId, columnName, clickedId )
				{
					var editId = document.getElementById( clickedId ).id.replace( columnId, "" );
					window.editId = editId;
								
					var deletableElement = document.getElementById( clickedId );
					
					var addTextbox = document.createElement( "td" );
					addTextbox.id = columnId + editId;
					addTextbox.innerHTML +=
							[
								'<input type="text" id="textHomework" onblur="saveClick(this.id)"/>'
							].join( "" );
					document.body.appendChild( addTextbox );
					document.getElementById( "textHomework" ).id = "text" + columnName;
					
					if ( columnId === "subject" )
					{
						document.getElementById( "text" + columnName ).value = valuesArray[ editId ][ 1 ];
					}
					
					else if ( columnId === "homework" )
					{
						document.getElementById( "text" + columnName ).value = valuesArray[ editId ][ 2 ];
					}
					
					else
					{
						document.getElementById( "text" + columnName ).type = "date";
						document.getElementById( "text" + columnName ).value = valuesArray[ editId ][ 3 ];
					}

					deletableElement.parentNode.replaceChild( addTextbox, deletableElement );

					document.getElementById( "text" + columnName ).focus();
				};
				
				var editClick = function( clickedId )
				{
					var clickId = document.getElementById( clickedId ).id;
					
					if ( isNaN( clickId.replace( "subject", "" ) ) === false )
					{
						editFunction( "subject", "Subject", clickedId );
					}
						
					else if ( isNaN( clickId.replace( "homework", "" ) ) === false )
					{
						editFunction( "homework", "Homework", clickedId );
					}
					
					else
					{
						editFunction( "deadline", "Deadline", clickedId );
					}
				};
				
				var saveFunction = function( columnId, columnName )
				{
					var deletableElement = document.getElementById( "text" + columnName ).parentNode;
					
					if ( columnId === "subject" )
					{
						valuesArray[ editId ][ 1 ] = document.getElementById( "textSubject" ).value;
					}
					
					else if ( columnId === "homework" )
					{
						valuesArray[ editId ][ 2 ] = document.getElementById( "textHomework" ).value;
					}
					
					else
					{
						valuesArray[ editId ][ 3 ] = document.getElementById( "textDeadline" ).value;
					}
					
					var addValue = document.createElement( "td" );
					addValue.id = columnId + editId;
					addValue.innerHTML +=
							[
								document.getElementById( "text" + columnName ).value
							].join( "" );
					document.body.appendChild(addValue);
					deletableElement.parentNode.replaceChild( addValue, deletableElement );
					
					if ( columnId === "subject" )
					{
						var subjectOnclick = document.getElementById( "subject" + editId );
						var onclickAttribute = document.createAttribute( "onclick" );
						onclickAttribute.value = "editClick(this.id)";
						subjectOnclick.setAttributeNode(onclickAttribute);
					}
					
					else if ( columnId === "homework" )
					{
						var homeworkOnclick = document.getElementById( "homework" + editId );
						onclickAttribute = document.createAttribute( "onclick" );
						onclickAttribute.value = "editClick(this.id)";
						homeworkOnclick.setAttributeNode(onclickAttribute);
					}
					
					else
					{
						document.getElementById( columnId + editId ).innerHTML = document.getElementById( columnId + editId ).innerHTML.replace( /\-/g, "." ) + ".";
						
						var deadlineOnclick = document.getElementById( "deadline" + editId );
						onclickAttribute = document.createAttribute( "onclick" );
						onclickAttribute.value = "editClick(this.id)";
						deadlineOnclick.setAttributeNode(onclickAttribute);
					}
				};
				
				var saveClick = function()
				{
					if ( document.getElementById( "textSubject" ) === null && document.getElementById( "textDeadline" ) === null )
					{
						saveFunction( "homework", "Homework" );
					}
					
					else if ( document.getElementById( "textDeadline" ) === null )
					{
						saveFunction( "subject", "Subject" );
					}
					
					else
					{
						saveFunction( "deadline", "Deadline" );
					}
				};
				
				var sortFunction = function( tdSortByNumber1, tdSortByNumber2, sortByColumnName, dataColumnName )
				{
					var tdTags = document.getElementsByTagName( "td" );
					var subjectValues = new Array();
					var homeworkValuesInDefaultSequence = new Array();
					window.homeworkValuesInDefaultSequence = homeworkValuesInDefaultSequence;
					var sortSubjectId = -1;
					var sortHomeworkId = -1;
					
					for ( var i = 10; i < tdTags.length - 1; i++ )
					{
						if ( i % 3 === tdSortByNumber1 )
						{
							sortSubjectId = sortSubjectId + 1;
							subjectValues[ sortSubjectId ] = tdTags[ i ].innerHTML;
						}
						
						else if ( i % 3 === tdSortByNumber2 )
						{
							sortHomeworkId = sortHomeworkId + 1;
							homeworkValuesInDefaultSequence[ sortHomeworkId ] = tdTags[ i ].innerHTML;
						}
					}
					
					var subjectValuesInDefaultSequence = new Array();
					
					for ( l = 0; l < subjectValues.length; l++ )
					{
						subjectValuesInDefaultSequence[ l ] = subjectValues [ l ];
					}
					
					window.subjectValuesInDefaultSequence = subjectValuesInDefaultSequence;
					
					subjectValues.sort();

					for ( var j = 0; j < subjectValues.length; j++ )
					{
						document.getElementById( sortByColumnName + ( j + 1 ) ).innerHTML = subjectValues[ j ];
					}
					
					for ( var k = 10; k < tdTags.length; k++ )
					{
						sortWhileNotEnd = true;
					}
				};
				
				var sortBySubject = function()
				{
					sortFunction( 2, 0, "subject", "homework" );
					
					tdTags = document.getElementsByTagName( "td" );
					var sortWhileNotEnd = true;
					var sortWhileId = -1;
					var sortWhileId2 = 0;
					
					for ( var k = 10; k < tdTags.length; k++ )
					{
						sortWhileNotEnd = true;
					
						while ( sortWhileNotEnd === true )
						{
							if ( k % 3 === 2 )
							{
								sortWhileId = sortWhileId + 1;
								
								if ( tdTags[ k ].innerHTML === subjectValuesInDefaultSequence[ sortWhileId ] )
								{
									sortWhileId2 = sortWhileId2 + 1;
									
									document.getElementById( "homework" + ( sortWhileId2 ) ).innerHTML = homeworkValuesInDefaultSequence[ sortWhileId ];
									
									subjectValuesInDefaultSequence[ sortWhileId ] = null;
									sortWhileId = -1;
									sortWhileNotEnd = false;
									
									homeworkValue[sortWhileId2] = document.getElementById( "homework" + ( sortWhileId2 ) ).innerHTML;
									subjectValue[sortWhileId2] = document.getElementById( "subject" + ( sortWhileId2 ) ).innerHTML;
								}
							}
								
							else
							{
								sortWhileNotEnd = false;
							}
						}
					}
				};
				
				var sortByHomework = function()
				{
					sortFunction( 0, 2, "homework", "subject" );
					
					tdTags = document.getElementsByTagName( "td" );
					var sortWhileNotEnd = true;
					var sortWhileId = -1;
					var sortWhileId2 = 0;
					
					for ( var k = 10; k < tdTags.length; k++ )
					{
						sortWhileNotEnd = true;
					
						while ( sortWhileNotEnd === true )
						{
							if ( k % 3 === 0 )
							{
								sortWhileId = sortWhileId + 1;
								
								if ( tdTags[ k ].innerHTML === subjectValuesInDefaultSequence[ sortWhileId ] )
								{
									sortWhileId2 = sortWhileId2 + 1;
									
									document.getElementById( "subject" + ( sortWhileId2 ) ).innerHTML = homeworkValuesInDefaultSequence[ sortWhileId ];
									
									subjectValuesInDefaultSequence[ sortWhileId ] = null;
									sortWhileId = -1;
									sortWhileNotEnd = false;
									
									subjectValue[sortWhileId2] = document.getElementById( "subject" + ( sortWhileId2 ) ).innerHTML;
									homeworkValue[sortWhileId2] = document.getElementById( "homework" + ( sortWhileId2 ) ).innerHTML;
								}
							}
							
							else
							{
								sortWhileNotEnd = false;
							}
						}
					}
				};
		</script>
		
	</body>
	
</html>